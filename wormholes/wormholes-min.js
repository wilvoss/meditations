var imgPreload,thumbPreload,tunnel,draggedElement,wormInt,r=document.querySelector(":root"),image1="url(images/big_28.jpg)",image1Small="url(images/small_28.jpg)",image2="url(images/big_27.jpg)",image2Small="url(images/small_27.jpg)",tunnels=document.getElementById("tunnels"),skin=document.getElementsByTagName("skin")[0],isGlass=!0,isSphere=!0,isDeep=!1,tempX=window.innerWidth<window.innerHeight?130:420,tempY=window.innerWidth<window.innerHeight?380:100,baseLineX=0,baseLineY=0,centerX=window.innerWidth/2,centerY=window.innerHeight/2,isDragging=!1,current=image1,worm=image2Small,currentNumber=28,wormNumber=27,wormInterval=window.setInterval(squiggleTunnels,8e3),wormTimer=window.setTimeout(squiggleTunnels,1),rings=document.getElementsByTagName("ring"),mouseDetected=!1,touchDetected=!1,changeScale=!1,count=1,scale=.9;function squiggleTunnels(){rings=document.getElementsByTagName("ring");for(let r=0;r<rings.length;r++){const a=rings[r];if("tunnel"==a.parentElement.tagName.toLowerCase()){var e=getRdmInt(4,12),n=getRdmInt(4,12),t=getRdmInt(9,12)/10;t=changeScale?t:1}a.randoX=e,a.randoY=n,a.randoScale=t}applySquiggles()}function applySquiggles(){for(let e=0;e<rings.length;e++){const n=rings[e];n.style.setProperty("--positionX",n.randoX+"px"),n.style.setProperty("--positionY",n.randoY+"px"),n.style.setProperty("--scale",n.randoScale)}}function blowOutTunnel(e,n){isDragging||(null!=e&&e.stopPropagation(),r.style.setProperty("--backgroundBlendMode","normal"),null!=tunnel&&null!=tunnel&&(tunnel=document.getElementById("tunnel"),tunnels=document.getElementById("tunnels"),skin=document.getElementsByTagName("skin")[0],tunnels.innerHTML="",skin.classList.add("blowout"),currentNumber=wormNumber,wormNumber=wormInt,toggleBackground(n),window.setTimeout((function(){skin.classList.remove("blowout"),tunnel=null}),250)))}function toggleBackground(e){current=e.style.backgroundImage.replace("small","big"),document.body.style.backgroundImage=current}function getRdmInt(e,n){return Math.floor(Math.random()*(n-e))+e}function touchMove(e){e.stopPropagation(),e.preventDefault(),trackTouch(e)}function touchStart(e){trackTouch(e)}function trackTouch(e){return tempX=e.touches[0].pageX,tempY=e.touches[0].pageY,tempX<0&&(tempX=0),tempY<0&&(tempY=0),dragElement(),touchDetected=!0}function GetMouseXY(e){return tempX=e.clientX,tempY=e.clientY,dragElement(),mouseDetected=!0}function beginDragging(e,n){e.stopPropagation(),e.preventDefault(),isDragging||(isDragging=!0,draggedElement=n)}function dragElement(){if(0==baseLineX&&null!=draggedElement&&null!=draggedElement){const e=window.getComputedStyle(draggedElement).transform,n=e.match(/matrix.*\((.+)\)/);if(null!=n&&n.length>0){const n=e.match(/matrix.*\((.+)\)/)[1].split(", ");baseLineX=tempX-n[4],baseLineY=tempY-n[5]}}if(isDragging){var e=tempX-baseLineX,n=tempY-baseLineY;draggedElement.tempLeft=e,draggedElement.tempTop=n,applyDrag()}}function applyDrag(){draggedElement.style.transform="translate("+draggedElement.tempLeft+"px, "+draggedElement.tempTop+"px)"}function stopDragging(e,n){e.stopPropagation(),e.preventDefault(),isDragging=!1,baseLineX=0,baseLineY=0,draggedElement=null}function toggleGlass(e){e.stopPropagation(),e.preventDefault(),isGlass=!isGlass,null!=tunnel&&(tunnel.className=isGlass?"init":"init dark",r.style.setProperty("--tunnelBackground",isGlass?"var(--glassRings)":"var(--darkRings)")),document.body.className=isGlass?"glass":"",document.getElementById("glassValue").innerHTML=isGlass}function toggleSphere(e){e.stopPropagation(),e.preventDefault(),isSphere=!isSphere,r.style.setProperty("--tunnelSphere",isSphere?"-30px -30px 120px var(--tunnelMediumDark)":"none"),document.getElementById("sphereValue").innerHTML=isSphere}function toggleDepth(e){e.stopPropagation(),e.preventDefault(),isDeep=!isDeep,r.style.setProperty("--tunnelDepth",isDeep?"75%":"82%"),document.getElementById("depthValue").innerHTML=isDeep}function toggleAnimation(e){changeScale=!changeScale,document.getElementById("animateCheckboxValue").innerHTML=changeScale,squiggleTunnels()}var tunnelInc=0;function clearAllTunnels(){for(let e=(tunnels=document.getElementsByTagName("tunnel")).length-1;e>=0;e--){const n=tunnels[e];document.getElementsByTagName("tunnels")[0].removeChild(n)}r.style.setProperty("--backgroundBlendMode","normal")}function placeTunnel(e){if(e.preventDefault(),e.stopPropagation(),!isDragging||null==draggedElement){r.style.setProperty("--backgroundBlendMode","luminosity"),tunnels=document.getElementById("tunnels");var n=getRdmInt(10,15),t=tempX-50,a=tempY-30;(tunnel=document.createElement("tunnel")).className="init"+(isGlass?" glass":" dark"),tunnel.style.transform="translate("+t+"px, "+a+"px)",tunnels.appendChild(tunnel),tunnel.style.width=n+"em",tunnel.style.height=n+"em",tunnel.id="tunnel"+tunnelInc++;var l=document.createElement("ring");tunnel.appendChild(l);var o=document.createElement("ring");l.appendChild(o);var i=document.createElement("ring");o.appendChild(i);var s=document.createElement("ring");i.appendChild(s);var g=document.createElement("ring");s.appendChild(g);var m=document.createElement("ring");g.appendChild(m);var u=document.createElement("ring");m.appendChild(u);var d=document.createElement("ring");d.className="exit",u.appendChild(d),setTimeout((()=>{d.onpointerdown=function(){blowOutTunnel(e,d)},tunnel.onpointerdown=function(){beginDragging(e,this)},tunnel.onpointerup=function(){stopDragging(e,this)},tunnel.ondragstart=()=>!1}),300),window.clearInterval(wormInterval),window.clearTimeout(wormTimer),currentNumber=wormNumber,worm="url("+thumbPreload.src+")",wormInt=preloadWormInt();var c=document.createElement("img");c.src="images/big_"+wormInt+".jpg",c.title="This is a non-visible large placeholder for pre-caching upcoming images.",c.onload=function(){document.body.removeChild(this)},document.body.appendChild(c),thumbPreload.src="images/small_"+wormInt+".jpg",d.style.backgroundImage=worm,wormInterval=window.setInterval(squiggleTunnels,8e3),wormTimer=window.setTimeout(squiggleTunnels,100)}}function test(){alert("hi")}function preloadWormInt(){var e=getRdmInt(1,36);if(e==currentNumber)for(;Number(e)==Number(currentNumber)&&(e=getRdmInt(1,36))==currentNumber;);return e}function onKeyUp(e){switch(e.key.toLowerCase()){case"g":toggleGlass(e);break;case"r":toggleSphere(e);break;case"d":toggleDepth(e);break;case"o":toggleAnimation(e);break;case"escape":clearAllTunnels();break}}window.onload=function(){wormInt=preloadWormInt(),(imgPreload=document.createElement("img")).id="preloadLarge",imgPreload.title="This is a non-visible large placeholder for pre-caching upcoming images.",imgPreload.src="images/big_"+wormInt+".jpg",document.body.appendChild(imgPreload),(thumbPreload=document.createElement("img")).id="preloadSmall",thumbPreload.style.overflow="hidden",thumbPreload.title="This is a non-visible small placeholder for pre-caching upcoming images.",thumbPreload.src="images/small_"+wormInt+".jpg",document.body.appendChild(thumbPreload)},window.addEventListener?window.addEventListener("keyup",onKeyUp):window.attachEvent("onkeyup",onKeyUp),window.onunload=function(){window.clearInterval(wormInterval),window.clearTimeout(wormTimer)},window.onpointermove=GetMouseXY,window.addEventListener("touchmove",touchMove,!1),window.addEventListener("touchstart",touchStart,!1);